{"data":{"markdownRemark":{"fileAbsolutePath":"/Users/nogueira_hugo/workspace/hugomn/hugomagalhaes.com/src/pages/blog/how-to-develop-reusable-components-with-babel-and-rollupjs.pt.md","html":"<p>No dia 10 de Outubro, tive o prazer de falar sobre componentes reutilizáveis utilizando a biblioteca Rollup.js, no meetup <a href=\"https://www.meetup.com/React-Open-Source/\">React Open Source</a>, em Berlin. Tentei mostrar, de forma simples, o contexto da criação do conceito de módulos em JavaScript e fiz uma sessão de live coding, mostrando como criar e publicar componentes reutilizáveis. Assista ao vídeo completo no final desse post.</p>\n<h2>Por que eu precisaria expor meus componentes?</h2>\n<p>Existem diversos motivos e exemplos de situações em que é interessante criarmos componentes reutilizáveis. É importante listarmos alguns deles:</p>\n<h3>1. Compartilhamento de componentes entre diferentes aplicações</h3>\n<p>Esse é o caso mais óbvio e mais comum. A ideia essencial da arquitetura de componentes é criar partes reutilizáveis de código. Um exemplo clássico de reutilização é a criação de componentes de UI que podem ser reutilizados em diferentes aplicações.</p>\n<h3>2. Compartilhamento de configuração</h3>\n<p>Um outro caso bastante comum de reutilização acontece quando precisamos compartilhar configurações entre projetos. Uma forma simples de fazer isso é compilar as configurações como componentes.</p>\n<h3>3. Criação de micro-services para aplicações front-end</h3>\n<p>A arquitetura de micro-serviços é uma técnica de desenvolvimento e deploy que utiliza serviços com responsabilidades bem definidas e totalmente desacordados, facilitando a manutenção e evolução do sistema. Essa abordagem tem se tornado comum em aplicações front-end e a utilização de componentes reutilizáveis é uma forma de desenvolver micro-services.</p>\n<h2>Como gerenciar encapsulamento e dependência em JavaScript?</h2>\n<p>Um princípio básico para a criação de componentes independentes e reutilizáveis é que os mesmos sejam encapsulados e que haja um bom gerenciamento de dependências. Para resolver esse problema, foi introduzido o conceito de módulos JavaScript. </p>\n<p>Inicialmente, eram utilizadas funções imediatamente executadas (IIFE) e o padrão “Revelling module” para a criação de componentes, como no exemplo a seguir:</p>\n<script src=\"https://gist.github.com/hugomn/0324b8515dddff5c4c30b18d581a1021.js\"></script>\n<h3>CommonJS</h3>\n<p>Em Janeiro de 2009, porém, Kevin Danger iniciou o projeto de criação do CommonJS para que houvesse uma melhor padronização de componentes JavaScript, principalmente para <em>scripts server-side</em>. O projeto foi inicialmente chamado de <strong>ServerJS</strong>. O projeto iniciou os conceitos de <strong>require</strong>, <strong>exports</strong> and <strong>module</strong>.</p>\n<p>Porém em Maio de 2013, Isaac Z. Schlueter, autor do npm, gerenciador de pacotes do Node.js, disse que CommonJS estava sendo descontinuado pelo Node.js, e que seria evitado pelos mantenedores do projeto. Segue abaixo um exemplo de módulo utilizando CommonJS:</p>\n<script src=\"https://gist.github.com/hugomn/dd0ee6ab22228ad409311eccc91d14c4.js\"></script>\n<script src=\"https://gist.github.com/hugomn/4e386b62684967a4cd691a3e2d408a45.js\"></script>\n<h3>Asynchronous Module Definition (AMD)</h3>\n<p>Como a implementação de CommonJS não era compatível com os browsers, foi criada a definição de módulos assíncronos, ou AMD. A AMD foi criada para ser usada nos browsers para melhorar o tempo de startup das aplicações, e tais módulos poderiam ser objetos, funções, construtores, strings, JSON, etc. Abaixo um exemplo de módulo AMD:</p>\n<script src=\"https://gist.github.com/hugomn/bd04b870151a2c1c61ca696ebfcff6d0.js\"></script>\n<h3>Módulos ES2015</h3>\n<p>Os módulos ES2015 foram implementados na recente implementação ECMAScript 2015 do Javascript, e é compatível com as abordagens <strong>assíncrona</strong> e <strong>síncrona</strong>. E tem uma grande vantagem: <strong>é JavaScript nativo!</strong>. Porém não está completamente disponível em todos os browsers e para isso precisa de um <strong>transpilador</strong> como <strong>Babel</strong> por exemplo para a execução em browsers não suportados.</p>\n<script src=\"https://gist.github.com/hugomn/8cf95a5619aac64bebd220abe21acf00.js\"></script>\n<script src=\"https://gist.github.com/hugomn/c7970afb33ff7a1af5b476a89a4a844b.js\"></script>\n<p>Agora que vimos uma rápida introdução aos módulos em JavaScript, vamos entender como <strong>Rollup.js</strong> pode nos ajudar a compilar nossos componentes em componentes reutilizáveis.</p>\n<h2>O que é Rollup.js?</h2>\n<p>Rollup é um <em>bundler</em> de módulos para JavaScript que compila partes pequenas de código em algo maior e mais complexo, como uma biblioteca ou uma aplicação. </p>\n<p>Você deve estar se perguntando? <strong>Por que não Webpack?</strong> Webpack foi criado basicamente como um <em>bundler</em> para web applications, principalmente para resolver os problemas de <em>code-splitting</em> e gerenciamento de assets. Recentemente ambas biblioteca cresceram muito e são capazes de resolver a maioria dos problemas, tanto para bibliotecas, quando para web applications. Porém, o senso comum entre os <em>bundlers</em> tem sido o seguinte:</p>\n<blockquote>\n<p>Para aplicações completas, utilize <strong>Webpack</strong>. Para bibliotecas, utilize <strong>Rollup.js</strong>.</p>\n</blockquote>\n<h2>Talk is cheap, show me the code</h2>\n<p>Vamos finalmente ao nosso exemplo. Nesse exemplo, irei utilizar um componente extremamente básico em <strong>React</strong>. Criaremos um <strong>Header</strong>, e o compilaremos para que seja reutilizado em outros projetos! </p>\n<h4>1. Primeiro, instalamos Rollup.js globalmente</h4>\n<p><code class=\"language-text\">npm install --global rollup</code></p>\n<h4>2. Agora, criamos nosso componente de cabeçalho básico</h4>\n<p>Nosso componente terá apenas uma tag <strong><h1></strong>, e será publicado no npm para que possa ser utilizado por outros projetos:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// src/header.js</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Header</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>Hello<span class=\"token punctuation\">,</span> <span class=\"token constant\">DV</span><span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Header<span class=\"token punctuation\">;</span></code></pre></div>\n<h4>3. Precisamos exportar nosso componente de Cabeçalho</h4>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// src/main.js</span>\n<span class=\"token keyword\">import</span> Header <span class=\"token keyword\">from</span> <span class=\"token string\">\"./header.js\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Header<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Como pretendemos utilizar módulos ES6, precisaremos instalar e configurar o <strong>Babel</strong> para que nosso componente seja corretamente compilado.</p>\n<h4>4. Instalando e configurando o Babel</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">npm install --save-dev @babel/core @babel/cli @babel/present-env @babel/present-react</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// babel.config.js</span>\n<span class=\"token keyword\">const</span> presets <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"@babel/env\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      modules<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">[</span><span class=\"token string\">\"@babel/preset-react\"</span><span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> presets <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Agora que já instalamos e configuramos o Babel, precisamos instalar o plugin para o <strong>Rollup.js</strong> que fará a integração com <strong>Babel</strong>:</p>\n<h4>5. Instalando o plugin do Babel para o Rollup.js</h4>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">npm install --save-dev rollup-plugin-babel</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// rollup.config.js</span>\n<span class=\"token keyword\">import</span> babel <span class=\"token keyword\">from</span> <span class=\"token string\">\"rollup-plugin-babel\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    input<span class=\"token punctuation\">:</span> <span class=\"token string\">\"src/main.js\"</span><span class=\"token punctuation\">,</span>\n    output<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"reusableComponents\"</span><span class=\"token punctuation\">,</span>\n      file<span class=\"token punctuation\">:</span> <span class=\"token string\">\"dist/main.js\"</span><span class=\"token punctuation\">,</span>\n      format<span class=\"token punctuation\">:</span> <span class=\"token string\">\"iife\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    external<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"react\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token function\">babel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        exclude<span class=\"token punctuation\">:</span> <span class=\"token string\">\"node_modules/**\"</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Muita atenção na linha <strong>external: [“react”]</strong>. Sem essa configuração, o Rollup irá compilar todo o código-fonte do React junto com seu componente.</p>\n<p>Agora já podemos compilar nosso componente:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">rollup -c</code></pre></div>\n<p>Após compilado, seu biblioteca estará compilada e disponível em <strong>dist/main.js</strong>. Como etapa final, precisamos apenas publicar seu componente no repositório do npm, para que possa ser utilizado por outros projetos. </p>\n<h4>6. Publicando sua biblioteca no ppm</h4>\n<p>Antes de publicar sua biblioteca, você precisa ser logar no npm, e provavelmente precisará configurar as chaves SSH de sua conta. </p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">npm login</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">npm publish --access=public</code></pre></div>\n<p>Pronto! Após publicado, sua biblioteca e seus componentes já estarão disponíveis para serem usados via <code class=\"language-text\">npm install</code> em seus outros projetos. 🎉</p>\n<h4>7. <strong>Dica bônus:</strong> Usando <code class=\"language-text\">npm link</code> para configurar seu ambiente de desenvolvimento</h4>\n<p>Para evitar que você tenha que publicar e atualizar seu componente toda vez que fizer alguma alteração, existe uma forma simples de referenciar seu componente localmente em seus projetos. </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1. Em sua biblioteca, crie um link virtual utilizando o commando `npm link`.\n2. No projeto que utiliza sua biblioteca, execute o mesmo comando, agora referenciando a biblioteca, por exemplo: `npm link @hugomn/reusable-components`.</code></pre></div>\n<p>Pronto! Agora você tem um ambiente completo e simples para desenvolver seus componentes reutilizáveis. Espero que gostem e, por favor, enviem qualquer dúvida ou feedback que tiverem. 🤘🏻</p>\n<h2>Vídeo completo no YouTube</h2>\n<p>Abaixo estão o vídeo completo e os slides da apresentação que fiz (em inglês) para o meetup React Open Source, no dia 10 de outubro de 2018, em Berlim.</p>\n<div class=\"container\" style=\"position: relative; width: 100%; height: 0; padding-bottom: 56.25%; margin-bottom: 40px\"><iframe src=\"https://www.youtube.com/embed/Dve_bYaAVZ0\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen style=\"position: absolute; top: 0; left: 0; width: 100%; height: 100%;\"></iframe></div>\n<div style=\"left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.1987%;\"><iframe src=\"//speakerdeck.com/player/95ae0fbc24be49d88f1a7a0b333e984f\" style=\"border: 0; top: 0; left: 0; width: 100%; height: 100%; position: absolute;\" allowfullscreen scrolling=\"no\"></iframe></div>","excerpt":"No dia 10 de Outubro, tive o prazer de falar sobre componentes reutilizáveis utilizando a biblioteca Rollup.js, no meetup  React Open Source…","fields":{"tagSlugs":[{"tag":"javascript","link":"/pt/tags/javascript/"},{"tag":"rollup.js","link":"/pt/tags/rollup-js/"}],"slug":"/pt/blog/how-to-develop-reusable-components-with-babel-and-rollupjs/","readNextPosts":[{"excerpt":"One (or two) of the most important features that came with ES2015 (ES6) was  the addition of   and   which can be used for variable…","frontmatter":{"title":"var, let or const?","date":"2018-08-06"},"fields":{"slug":"/pt/blog/var-let-or-const/","langKey":"pt"}},{"excerpt":"After reading the book “The 7 Habits of Highly Successful People”, written by S. Covey, I understood the real importance of having a clear…","frontmatter":{"title":"Primeiro post","date":"2018-08-01"},"fields":{"slug":"/pt/blog/my-personal-mission-statement/","langKey":"pt"}}]},"frontmatter":{"title":"Como desenvolver componentes reutilizáveis utilizando Babel and RollupJS","tags":["javascript","rollup.js"],"date":"2018-09-26","image":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAF/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgED/9oADAMBAAIQAxAAAAFx0lF1Y08//8QAGxABAQABBQAAAAAAAAAAAAAAAgEAAxESEyP/2gAIAQEAAQUC1DOAsiK3j9AZTexZ/8QAGhEAAQUBAAAAAAAAAAAAAAAAAAECERIiMf/aAAgBAwEBPwHMF2p0/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERIf/aAAgBAgEBPwHbCM//xAAcEAACAQUBAAAAAAAAAAAAAAAAARECEiExMkH/2gAIAQEABj8CouJwzTEzqTw//8QAGxAAAwEBAAMAAAAAAAAAAAAAAREhADFBccH/2gAIAQEAAT8hE4V4eVbIrzUkexgJEqQLI9Aeka5+N//aAAwDAQACAAMAAAAQrD//xAAYEQEAAwEAAAAAAAAAAAAAAAABACFB8P/aAAgBAwEBPxACFOyNBXP/xAAYEQADAQEAAAAAAAAAAAAAAAAAATERIf/aAAgBAgEBPxBrkppEf//EAB0QAQEAAgIDAQAAAAAAAAAAAAERADEhQWFxgZH/2gAIAQEAAT8QqA5RD57yzOStsyb7fHvBPexEEwds1Axe78y9aCHUWP5iRqow+Pef/9k=","aspectRatio":1.5,"src":"/static/131a11fa1d78409ce00d89eb763ca038/f2b68/20180926.jpg","srcSet":"/static/131a11fa1d78409ce00d89eb763ca038/0f1b0/20180926.jpg 188w,\n/static/131a11fa1d78409ce00d89eb763ca038/b8241/20180926.jpg 375w,\n/static/131a11fa1d78409ce00d89eb763ca038/f2b68/20180926.jpg 750w","sizes":"(max-width: 750px) 100vw, 750px"}}},"structuredData":null}}},"pageContext":{"langKey":"pt"}}